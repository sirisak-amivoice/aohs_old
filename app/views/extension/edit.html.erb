<% content_for :header do %>
  <script type="text/javascript">
    var mode = 0;
    $(document).ready(function(){

      $(function(){
        $("#diddetail tr").mouseover(function(){
          $(this).addClass('tr-selected');
        }).mouseout(function(){
          $(this).removeClass('tr-selected');
        });
      });
    });
    
    function del_manager(id,ext){
        $("#delDialog").text("");
        $("#delDialog").append("Are you sure to delete extension number \"<b>" + ext + "</b>\"");
        $("#delDialog").dialog("open");
        $("#delDialog").dialog({
          bgiframe: true,
          title: "Deleting Extension...",
          modal: true,
          buttons:{
            "Cancel": function(){ $(this).dialog("close"); },
            "Ok": function(){ window.location = "<%= url_for(:controller => 'extension',:action => 'delete') %>/" + id ; }
          }
        });
    }

      function del_did(id,ext){
        $("#delDialog").text("");
        $("#delDialog").append("Are you sure to delete dids number \"<b>" + ext + "</b>\"");
        $("#delDialog").dialog("open");
        $("#delDialog").dialog({
          bgiframe: true,
          title: "Deleting Extension...",
          modal: true,
          buttons:{
            "Cancel": function(){ $(this).dialog("close"); },
            "Ok": function(){ window.location = "<%= url_for(:controller => 'extension',:action => 'delete_did') %>/" + id ; }
          }
        });
     }
    </script>
<% end %>
<% content_for :submenu do %>
  <div id="submenu">
    <table width="100%">
      <tr>
        <td align="left">
          <ul>
            <li><%= link_image_tag('Back','back.png',{:controller => "extension",:action => 'index'},{:title => 'Back to extension list'}) %></li>
            <li><%= link_image_tag('Add did','new.png',{:controller => "extension",:action => 'new_did',:ext_id => params[:id]},{:title => 'Add new did number'}) %></li>
            <li><%= link_image_tag('Extension details','detail.png',{:controller => "extension",:action=>"show", :id => @extension.id},{:title => 'Show details'}) %></li>
            <li><%= link_image_tag('Delete extension','delete.png','#',{:onclick => "del_manager(#{@extension.id},\"#{@extension.number}\")",:title => 'Delete'}) %></li>
          </ul>
        </td>
        <td align="right">

        </td>
      </tr>
    </table>
  </div>
<% end %>
<div class="div-form-default-style1">
     <% form_for(@extension,:url=>{:controller=>'extension',:action=>'update',:id => @extension.id})  do |f| %>
        <table width="100%" cellpadding="0" cellspacing="0">
        <tr>
            <td><span class="span-form-name">Extension infomation</span>
            </td>
        </tr>
        <tr>
            <td>
            <%=display_frm_error(flash[:message]) %>
            <%=display_frm_success(flash[:notice]) %>
            <table class="tbl-frm-details" cellpadding="0" cellspacing="0">
            <tr>
              <td width="130px" align="left" valign="top"><label>Extension number:</label></td>
              <td width="300px"><%= f.text_field :number,{:class =>'input-text',:size => 20,:maxsize => 20} %><span class="span-require">*</span></td>
            </tr>
            <tr>
              <td></td>
              <td><%= submit_tag "Update extension",{:class => 'btnAccept'} %></td>
            </tr>
        </table>
      </td>
    </tr>
    <tr>
    <tr>
      <td><span class="span-form-name">Dids</span></td>
    </tr>
      <td style="padding-top:5px;">
        <div class="div-tbl-default-style1">
          <table cellpadding="0" cellspacing="0" >
            <thead>
            <tr>
                <th>#</th>
                <th>Number</th>
                <th>Edit</th>
                <th>Delete</th>
            </tr>
            </thead>
            <tbody id="diddetail">
            <% unless @extension.dids.blank? %>
                <% @extension.dids.each_with_index do |dn,i| %>
                <tr class="<%=cycle('tr-odd','tr-even')%>" >
                    <td width="40px"><%= i + 1 %></td>
                    <td class="string"><%= dn.number unless dn.number.nil? %></td>
                    <td width="45px">
                <%=link_image_tag('','edit.png','#',{:onclick => "window.location.href=\"#{url_for(:controller => 'extension',:action =>"edit_did",:id =>dn.id)}\";",:title => 'edit',:style => 'display:block;',:id=>"l1"}) %>
                    </td>
                    <td width="45px">
                <%= link_image_tag('','delete.png','#',{:onclick => "del_did(#{dn.id},\"#{dn.number}\")",:title => 'Delete'}) %>
                    </td>
                </tr>
                <% end %>
            <% else %>
               <tr align="center">
                  <td colspan="4"><span class="span-display-none">No dids.</span></td>
               </tr>
              <% end %>
              </tbody>
          </table>
          <br>
        </div>
      </td>
    </tr>
  </table>
  <% end %>
</div>